<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catherine's To-Do Lists</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            background: linear-gradient(135deg, #fce4ec 0%, #f8bbd0 25%, #e1f5dd 50%, #c8e6c9 75%, #fce4ec 100%);
            background-size: 400% 400%;
            animation: floral-gradient 15s ease infinite;
        }

        @keyframes floral-gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(233, 30, 99, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(76, 175, 80, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(244, 143, 177, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .app-container {
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .home-view {
            max-width: 800px;
            margin: 0 auto;
        }

        .app-title {
            text-align: center;
            font-size: 2.5rem;
            color: #c2185b;
            margin-bottom: 2rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            font-weight: 600;
        }

        .new-list-section {
            display: flex;
            gap: 10px;
            margin-bottom: 2rem;
            background: white;
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(194, 24, 91, 0.15);
        }

        .new-list-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #f48fb1;
            border-radius: 8px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s;
        }

        .new-list-input:focus {
            border-color: #c2185b;
        }

        .create-list-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            background: linear-gradient(135deg, #e91e63, #c2185b);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .create-list-btn:hover {
            transform: translateY(-2px);
        }

        .lists-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .list-card {
            background: white;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(194, 24, 91, 0.15);
            transition: transform 0.2s;
        }

        .list-card:hover {
            transform: translateY(-4px);
        }

        .list-card h3 {
            color: #c2185b;
            margin-bottom: 8px;
            font-size: 1.3rem;
        }

        .list-card p {
            color: #666;
            margin-bottom: 16px;
        }

        .list-card-actions {
            display: flex;
            gap: 10px;
        }

        .open-btn {
            flex: 1;
            padding: 10px;
            background: linear-gradient(135deg, #4caf50, #388e3c);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: transform 0.2s;
        }

        .open-btn:hover {
            transform: scale(1.05);
        }

        .delete-list-btn {
            padding: 10px;
            background: #ffebee;
            color: #c2185b;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .delete-list-btn:hover {
            background: #ffcdd2;
        }

        .list-view {
            max-width: 800px;
            margin: 0 auto;
        }

        .header {
            margin-bottom: 2rem;
        }

        .header-top {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 1rem;
        }

        .home-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: white;
            color: #c2185b;
            border: 2px solid #f48fb1;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }

        .home-btn:hover {
            background: #fce4ec;
        }

        .list-title {
            flex: 1;
            font-size: 2rem;
            color: #c2185b;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .controls {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .toggle-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: white;
            color: #4caf50;
            border: 2px solid #a5d6a7;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }

        .toggle-btn:hover {
            background: #e8f5e9;
        }

        .add-task-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: linear-gradient(135deg, #e91e63, #c2185b);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: transform 0.2s;
        }

        .add-task-btn:hover {
            transform: translateY(-2px);
        }

        .tasks-container {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 16px rgba(194, 24, 91, 0.15);
        }

        .task-item {
            margin-bottom: 8px;
        }

        .task-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            background: #fafafa;
            border-radius: 8px;
            transition: background 0.2s;
        }

        .task-row:hover {
            background: #f5f5f5;
        }

        .task-left {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
        }

        .expand-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: #666;
            padding: 4px;
            display: flex;
            align-items: center;
            transition: color 0.2s;
            width: 20px;
            height: 20px;
        }

        .expand-btn:hover {
            color: #c2185b;
        }

        .checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #f48fb1;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .checkbox:hover {
            border-color: #c2185b;
        }

        .checkbox.checked {
            background: linear-gradient(135deg, #e91e63, #c2185b);
            border-color: #c2185b;
            color: white;
        }

        .task-input {
            flex: 1;
            border: none;
            background: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 1rem;
            outline: none;
            border: 2px solid #f48fb1;
        }

        .task-input:focus {
            border-color: #c2185b;
        }

        .task-text {
            flex: 1;
            cursor: pointer;
            color: #333;
            font-size: 1rem;
            transition: color 0.2s;
        }

        .task-text:hover {
            color: #c2185b;
        }

        .task-text.completed {
            text-decoration: line-through;
            color: #999;
        }

        .task-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .progress-badge {
            background: linear-gradient(135deg, #4caf50, #388e3c);
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .icon-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 6px;
            border-radius: 6px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
        }

        .add-btn {
            color: #4caf50;
        }

        .add-btn:hover {
            background: #e8f5e9;
        }

        .delete-btn {
            color: #e91e63;
        }

        .delete-btn:hover {
            background: #fce4ec;
        }

        .subtasks {
            margin-left: 40px;
            margin-top: 8px;
            border-left: 2px solid #f48fb1;
            padding-left: 16px;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #999;
            font-size: 1.1rem;
        }

        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #e91e63, #c2185b);
            color: white;
            padding: 24px 40px;
            border-radius: 16px;
            font-size: 1.5rem;
            font-weight: 600;
            box-shadow: 0 8px 24px rgba(194, 24, 91, 0.4);
            animation: celebrate 0.5s ease;
            z-index: 1000;
        }

        @keyframes celebrate {
            0% {
                transform: translate(-50%, -50%) scale(0.8);
                opacity: 0;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.1);
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        .hidden {
            display: none;
        }

        svg {
            width: 16px;
            height: 16px;
        }
    </style>
</head>
<body>
    <div id="app" class="app-container"></div>

    <script>
        // SVG Icons as strings
        const icons = {
            plus: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>',
            trash: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>',
            home: '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>',
            eye: '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>',
            eyeOff: '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>',
            check: '<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>',
            chevronDown: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>',
            chevronRight: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>'
        };

        const encouragingMessages = [
            "You're doing great!", "Amazing work!", "Keep it up!", "You're on fire!",
            "Fantastic job!", "You're crushing it!", "Way to go!", "Stellar work!",
            "You're unstoppable!", "Brilliant!", "You're a star!", "Phenomenal!",
            "Keep shining!", "You've got this!", "Superb effort!", "You're amazing!",
            "Outstanding!", "You're making magic happen!", "Wonderful progress!",
            "You're doing beautifully!", "Excellent work!", "You're incredible!",
            "Marvelous!", "You're on a roll!", "Splendid job!", "You're thriving!",
            "Impressive!", "You're glowing!", "Magnificent!", "You're blooming!",
            "Fabulous!", "You're flourishing!", "Radiant work!", "You're succeeding!",
            "Delightful!", "You're achieving greatness!", "Graceful progress!",
            "You're empowered!", "Lovely work!", "You're on the right path!",
            "Beautiful effort!", "You're growing stronger!", "Charming work!",
            "You're mastering this!", "Elegant progress!", "You're winning!"
        ];

        class TodoApp {
            constructor() {
                this.lists = [];
                this.currentListId = null;
                this.showCompleted = true;
                this.celebration = null;
                this.loadFromStorage();
                this.render();
            }

            loadFromStorage() {
                const saved = localStorage.getItem('catherineTodoLists');
                if (saved) {
                    this.lists = JSON.parse(saved);
                    if (this.lists.length > 0 && !this.currentListId) {
                        this.currentListId = this.lists[0].id;
                    }
                }
            }

            saveToStorage() {
                if (this.lists.length > 0) {
                    localStorage.setItem('catherineTodoLists', JSON.stringify(this.lists));
                }
            }

            createList(name) {
                if (!name.trim()) return;
                const newList = {
                    id: Date.now(),
                    name: name,
                    tasks: []
                };
                this.lists.push(newList);
                this.currentListId = newList.id;
                this.saveToStorage();
                this.render();
            }

            deleteList(listId) {
                this.lists = this.lists.filter(l => l.id !== listId);
                if (this.currentListId === listId) {
                    this.currentListId = this.lists.length > 0 ? this.lists[0].id : null;
                }
                this.saveToStorage();
                this.render();
            }

            getCurrentList() {
                return this.lists.find(l => l.id === this.currentListId);
            }

            updateCurrentList(updatedTasks) {
                this.lists = this.lists.map(l => 
                    l.id === this.currentListId ? { ...l, tasks: updatedTasks } : l
                );
                this.saveToStorage();
            }

            addTask(parentPath = []) {
                const list = this.getCurrentList();
                if (!list) return;

                const newTask = {
                    id: Date.now(),
                    text: '',
                    completed: false,
                    subtasks: [],
                    isEditing: true,
                    isExpanded: false
                };

                const addToNested = (tasks, path) => {
                    if (path.length === 0) {
                        return [...tasks, newTask];
                    }
                    return tasks.map((task, i) => 
                        i === path[0]
                            ? { ...task, subtasks: addToNested(task.subtasks, path.slice(1)), isExpanded: true }
                            : task
                    );
                };

                this.updateCurrentList(addToNested(list.tasks, parentPath));
                this.render();
                
                // Focus the new input
                setTimeout(() => {
                    const inputs = document.querySelectorAll('.task-input');
                    if (inputs.length > 0) {
                        inputs[inputs.length - 1].focus();
                    }
                }, 0);
            }

            updateTask(path, updates) {
                const list = this.getCurrentList();
                if (!list) return;

                const updateNested = (tasks, p) => {
                    if (p.length === 1) {
                        return tasks.map((task, i) => 
                            i === p[0] ? { ...task, ...updates } : task
                        );
                    }
                    return tasks.map((task, i) => 
                        i === p[0]
                            ? { ...task, subtasks: updateNested(task.subtasks, p.slice(1)) }
                            : task
                    );
                };

                this.updateCurrentList(updateNested(list.tasks, path));

                if (updates.completed === true) {
                    this.showCelebration();
                }

                this.render();
            }

            deleteTask(path) {
                const list = this.getCurrentList();
                if (!list) return;

                const deleteNested = (tasks, p) => {
                    if (p.length === 1) {
                        return tasks.filter((_, i) => i !== p[0]);
                    }
                    return tasks.map((task, i) => 
                        i === p[0]
                            ? { ...task, subtasks: deleteNested(task.subtasks, p.slice(1)) }
                            : task
                    );
                };

                this.updateCurrentList(deleteNested(list.tasks, path));
                this.render();
            }

            getProgress(task) {
                const count = (t) => {
                    const self = t.completed ? 1 : 0;
                    const children = t.subtasks.reduce((sum, st) => sum + count(st).completed, 0);
                    const total = 1 + t.subtasks.reduce((sum, st) => sum + count(st).total, 0);
                    return { completed: self + children, total };
                };
                return count(task);
            }

            showCelebration() {
                const message = encouragingMessages[Math.floor(Math.random() * encouragingMessages.length)];
                this.celebration = message;
                this.render();
                setTimeout(() => {
                    this.celebration = null;
                    this.render();
                }, 2000);
            }

            renderTaskItem(task, path) {
                const progress = this.getProgress(task);
                const hasSubtasks = task.subtasks.length > 0;
                const shouldShow = this.showCompleted || !task.completed;

                if (!shouldShow) return '';

                const subtasksHtml = task.isExpanded && hasSubtasks
                    ? `<div class="subtasks">
                        ${task.subtasks.map((subtask, i) => 
                            this.renderTaskItem(subtask, [...path, i])
                        ).join('')}
                       </div>`
                    : '';

                return `
                    <div class="task-item">
                        <div class="task-row">
                            <div class="task-left">
                                ${hasSubtasks ? `
                                    <button class="expand-btn" onclick="app.updateTask([${path}], { isExpanded: ${!task.isExpanded} })">
                                        ${task.isExpanded ? icons.chevronDown : icons.chevronRight}
                                    </button>
                                ` : '<span style="width: 20px;"></span>'}
                                <button class="checkbox ${task.completed ? 'checked' : ''}" 
                                        onclick="app.updateTask([${path}], { completed: ${!task.completed} })">
                                    ${task.completed ? icons.check : ''}
                                </button>
                                ${task.isEditing ? `
                                    <input type="text" 
                                           class="task-input" 
                                           value="${task.text || ''}"
                                           placeholder="Enter task..."
                                           onblur="app.updateTask([${path}], { isEditing: false })"
                                           onkeypress="if(event.key==='Enter') app.updateTask([${path}], { isEditing: false })"
                                           oninput="app.updateTaskText([${path}], this.value)">
                                ` : `
                                    <span class="task-text ${task.completed ? 'completed' : ''}"
                                          onclick="app.updateTask([${path}], { isEditing: true })">
                                        ${task.text || 'Untitled task'}
                                    </span>
                                `}
                            </div>
                            <div class="task-right">
                                ${hasSubtasks ? `
                                    <span class="progress-badge">
                                        ${progress.completed}/${progress.total}
                                    </span>
                                ` : ''}
                                <button class="icon-btn add-btn" 
                                        onclick="app.addTask([${path}])"
                                        title="Add subtask">
                                    ${icons.plus}
                                </button>
                                <button class="icon-btn delete-btn" 
                                        onclick="app.deleteTask([${path}])"
                                        title="Delete task">
                                    ${icons.trash}
                                </button>
                            </div>
                        </div>
                        ${subtasksHtml}
                    </div>
                `;
            }

            updateTaskText(path, text) {
                const list = this.getCurrentList();
                if (!list) return;

                const updateNested = (tasks, p) => {
                    if (p.length === 1) {
                        return tasks.map((task, i) => 
                            i === p[0] ? { ...task, text } : task
                        );
                    }
                    return tasks.map((task, i) => 
                        i === p[0]
                            ? { ...task, subtasks: updateNested(task.subtasks, p.slice(1)) }
                            : task
                    );
                };

                this.lists = this.lists.map(l => 
                    l.id === this.currentListId ? { ...l, tasks: updateNested(l.tasks, path) } : l
                );
            }

            renderHomeView() {
                return `
                    <div class="home-view">
                        <h1 class="app-title">Catherine's To-Do Lists</h1>
                        <div class="new-list-section">
                            <input type="text" 
                                   id="newListInput"
                                   class="new-list-input" 
                                   placeholder="New list name..."
                                   onkeypress="if(event.key==='Enter') app.handleCreateList()">
                            <button class="create-list-btn" onclick="app.handleCreateList()">
                                ${icons.plus} Create List
                            </button>
                        </div>
                        <div class="lists-grid">
                            ${this.lists.map(list => `
                                <div class="list-card">
                                    <h3>${list.name}</h3>
                                    <p>${list.tasks.length} tasks</p>
                                    <div class="list-card-actions">
                                        <button class="open-btn" onclick="app.openList(${list.id})">
                                            Open
                                        </button>
                                        <button class="delete-list-btn" onclick="app.deleteList(${list.id})">
                                            ${icons.trash}
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            renderListView() {
                const currentList = this.getCurrentList();
                if (!currentList) return '';

                return `
                    <div class="list-view">
                        <div class="header">
                            <div class="header-top">
                                <button class="home-btn" onclick="app.goHome()">
                                    ${icons.home} Home
                                </button>
                                <h1 class="list-title">${currentList.name}</h1>
                            </div>
                            <div class="controls">
                                <button class="toggle-btn" onclick="app.toggleCompleted()">
                                    ${this.showCompleted ? icons.eye : icons.eyeOff}
                                    ${this.showCompleted ? 'Hide' : 'Show'} Completed
                                </button>
                                <button class="add-task-btn" onclick="app.addTask()">
                                    ${icons.plus} Add Task
                                </button>
                            </div>
                        </div>
                        <div class="tasks-container">
                            ${currentList.tasks.length === 0 ? `
                                <div class="empty-state">
                                    <p>No tasks yet. Click "Add Task" to get started!</p>
                                </div>
                            ` : currentList.tasks.map((task, i) => 
                                this.renderTaskItem(task, [i])
                            ).join('')}
                        </div>
                    </div>
                `;
            }

            render() {
                const appDiv = document.getElementById('app');
                appDiv.innerHTML = `
                    ${this.currentListId === null ? this.renderHomeView() : this.renderListView()}
                    ${this.celebration ? `<div class="celebration">${this.celebration}</div>` : ''}
                `;
            }

            handleCreateList() {
                const input = document.getElementById('newListInput');
                if (input && input.value.trim()) {
                    this.createList(input.value);
                }
            }

            openList(listId) {
                this.currentListId = listId;
                this.render();
            }

            goHome() {
                this.currentListId = null;
                this.render();
            }

            toggleCompleted() {
                this.showCompleted = !this.showCompleted;
                this.render();
            }
        }

        // Initialize the app
        const app = new TodoApp();
    </script>
</body>
</html>
